FROM registry.fedoraproject.org/fedora:latest

RUN mkdir -p /srv/public/iso

RUN set -x && \
    dnf -y update && \
    dnf install -y samba && \
    dnf clean all && \
    rm -rf /var/cache/yum /var/cache/dnf

COPY smb.conf /etc/samba/smb.conf

EXPOSE 139

WORKDIR /srv/public/

RUN chmod 770 /var/log/samba && \
    chmod -R 777 /srv/public/

ENTRYPOINT ["/usr/sbin/smbd", "-F", "--no-process-group", "-s", "/etc/samba/smb.conf"]